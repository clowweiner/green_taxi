<!DOCTYPE html>

<svg width="1400" height="800"></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
<script src="https://d3js.org/topojson.v2.min.js"></script>

<script>

  var svg = d3.select("svg"),
      width = +svg.attr("width"),
      height = +svg.attr("height");
    
  var hexbin = d3.hexbin()
      .radius(20)
      .extent([[0, 0], [width, height]]);

  var projection = d3.geoMercator()
      .center([-73.94, 40.70])
      .scale(70000)
      .translate([(width) / 3, (height)/2]);
  
  var path = d3.geoPath()
      .projection(projection);
  
  function clickHex(d) {
      
      this.parentNode.appendChild(this);
      
      d3.select(this)
	  .transition()
	  .duration(5000)
	  .attr("transform", "translate(600,200)");
  }

  var colors = ["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]

  d3.json("hexGrid.GeoJSON", function(error, hex) {
      var hexes = svg.selectAll("path")
   	  .data(hex.features)
   	  .enter().append("path")
   	  .attr("class", "hex")
          .attr("d", path)
	  .attr("fill","green")
	  .on("click",clickHex)
	  .transition().delay(2000)
	  .on("start", function repeat() {
              d3.active(this)
		  .attr("fill", colors[0])
		  .transition().duration(2000)
	      	  .attr("fill", colors[1])
		  .transition().duration(2000)
	      	  .attr("fill", colors[2])
		  .transition().duration(2000)
	      	  .attr("fill", colors[3])
		  .transition().duration(2000)
	      	  .attr("fill", colors[4])
		  .transition().duration(2000)
	      	  .attr("fill", colors[5])
		  .transition().duration(2000)
	      	  .attr("fill", colors[6])
		  .transition().duration(2000)
	      	  .attr("fill", colors[7])
		  .transition().duration(2000)
		  .on("start", repeat);
	  });
  });

</script>
